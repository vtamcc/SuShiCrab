{"version":3,"sources":["assets/SuShiCarb/scripts/Game/Ui_Popup/Shop/ShuShiCarb.ItemShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport ShuShiCarbGameManager from \"../../../ShuShiCarb.GameManager\";\nimport Global from \"../../../ShuShiCarb.Global\";\nimport ShuShiCarbShopView from \"./ShuShiCarb.ShopView\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ShuShiCarbItemShop extends cc.Component {\n\n    @property(cc.Node)\n    nItemShop: cc.Node = null;\n    @property(cc.Label)\n    lbPrice: cc.Label = null;\n    @property(cc.Node)\n    nBtnBuy: cc.Node = null;\n    @property(cc.Node)\n    nStateBuy: cc.Node = null;\n   \n    @property(cc.Label)\n    lbLeverSpeedOld: cc.Label = null;\n    @property(cc.Label)\n    lbLeverSpeedNew: cc.Label = null;\n\n    @property(cc.SpriteFrame)\n    lsSpFItemShop: cc.SpriteFrame[] = [];\n    index = 0;\n    isCheck = false;\n    _data = null\n    itemId = 0;\n\n    onLoad() {\n        //this.checkClick();\n    }\n\n    setData(id) {\n        this.itemId = id;\n        switch (id) {\n            case 0: // hook\n                this.index = Global.hookIndex;\n                this._data = Global.dataHook[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                console.log(this._data,this.index);\n                break;\n            case 1: // Bag money\n                this.index = Global.bagIndex;\n                this._data = Global.dataBagMoney[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                this.lbLeverSpeedOld.node.active = false;\n                break;\n            case 2: // time Happy\n                this._data = Global.dataTimeHappy[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                this.lbLeverSpeedOld.node.active = false;\n                this.index = Global.timeIndex;\n\n                break;\n            default:\n                break;\n        }\n        this.updatePrice(this.index);\n\n    }\n\n    updatePrice(index) {\n        if (index < 4) {\n            this.lbPrice.string = this._data.price + ' ';\n            this.lbLeverSpeedOld.string = \"0\";\n            //this.lbLeverSpeedNew.string = this._data[index].gold ? this._data[index].gold + ' ' : this._data[index].time + ' ';\n            this.nBtnBuy.getComponent(cc.Button).interactable = true;\n            console.log(\"Vao If \")\n        } else {\n            this.lbPrice.string = \"Max\";\n            this.lbLeverSpeedNew.string = \"Max\";\n            this.lbLeverSpeedOld.string = \"Max\";\n            this.nBtnBuy.getComponent(cc.Button).interactable = false;\n            console.log(\"vao Else\");\n        }\n\n        this.updatePurchaseState();\n    }\n\n    savePurchaseState() {\n        let purchaseData = {\n            dataHook: Global.dataHook,\n            dataBagMoney: Global.dataBagMoney,\n            dataTimeHappy: Global.dataTimeHappy,\n            activeIndexHook: Global.hookIndex,\n        };\n        cc.sys.localStorage.setItem('itemShopData', JSON.stringify(purchaseData));\n        \n    \n\n    }\n\n    updatePurchaseState() {\n        for (let i = 0; i <= this.index; i++) {\n            this.nStateBuy.children[i].active = true;\n        }\n    }\n\n    checkBuy(): boolean {\n        return Global.totalGold >= this._data.price;\n    }\n\n    onBuy() {\n        if ( this.index < 4) {\n            this.nStateBuy.children[this.index].active = true;\n            Global.totalGold -= this._data.price;\n\n            switch (this.itemId) {\n                case 0:\n                    this.index++;\n                    Global.hookIndex = this.index;\n                    this._data = Global.dataHook[this.index];\n                    cc.sys.localStorage.setItem(\"hookIndex\", this.index)\n                    break;\n                case 1:\n                    this.index++;\n                    Global.checkBagMoney = true;\n                    Global.bagIndex = this.index;\n                    this._data = Global.dataBagMoney[this.index];\n                    cc.sys.localStorage.setItem(\"bagIndex\",this.index);\n                    cc.sys.localStorage.setItem(\"checkBagMoney\", JSON.stringify(Global.checkBagMoney));\n                    break;\n                case 2:\n                    this.index++\n                    Global.timeIndex = this.index;\n                    this._data = Global.dataTimeHappy[this.index];\n                    cc.sys.localStorage.setItem(\"timeIndex\", this.index);\n                    //console.log(\"Index \", this.index);\n                    break;\n            }\n            this.updatePrice(this.index);\n            this.savePurchaseState();\n            ShuShiCarbGameManager.instance.updateTotalGold();\n            ShuShiCarbShopView.instance.updateGold();\n            \n            //this.checkClick(); // Gọi lại checkClick để cập nhật trạng thái nút sau khi mua\n        }\n    }\n    // LIFE-CYCLE CALLBACKS:\n\n\n    // onLoad () {\n    //     this.index = JSON.parse(cc.sys.localStorage.getItem(\"itemIndex\")) || 0;\n    //     this.loadPurchaseState();\n    //     this.checkClick();\n    //     this.updatePrice(this.index);\n    // }\n\n    // loadPurchaseState() {\n    //     const purchaseData = JSON.parse(cc.sys.localStorage.getItem(\"purchaseData\")) || [];\n    //     for (let i = 0; i < Global.dataHook.length; i++) {\n    //         if (purchaseData[i]) {\n    //             Global.dataHook[i].isBuy = purchaseData[i].isBuy;\n    //             Global.dataHook[i].speed = purchaseData[i].speed;\n    //             this.nStateBuy.children[i].active = purchaseData[i].isBuy;\n    //         }\n    //     }\n    // }\n\n    // savePurchaseState() {\n    //     const purchaseData = Global.dataHook.map(item => ({\n    //         isBuy: item.isBuy,\n    //         speed: item.speed\n    //     }));\n    //     cc.sys.localStorage.setItem('purchaseData', JSON.stringify(purchaseData));\n    //     cc.sys.localStorage.setItem('activeIndex', JSON.stringify(Global.activeIndex));\n    //     cc.sys.localStorage.setItem('itemIndex', this.index.toString());\n    //     cc.sys.localStorage.setItem('speedHook', JSON.stringify(Global.speedHook));\n    //     cc.sys.localStorage.setItem('lengthHook', JSON.stringify(Global.lengthHook));\n    // }\n\n\n    // checkClick() {\n    //     // if(this.index < Global.dataHook.length) {\n    //     //     if(Global.totalGold >= Global.dataHook[this.index].price) {\n    //     //         this.nCheckmask.active = false;\n    //     //         this.isCheck = true;\n    //     //     }else {\n    //     //          this.nCheckmask.active = true;\n    //     //          this.isCheck = false;\n    //     //          this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\n    //     //      }\n    //     // }\n    //     if(this.index < Global.dataHook.length && Global.totalGold >= Global.dataHook[this.index].price) { \n    //             this.nCheckmask.active = false;\n    //             this.isCheck = true; \n    //     }\n    //     else {\n    //         this.nCheckmask.active = true;\n    //         this.isCheck = false;\n    //         this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\n    //     }\n    //     console.log(this.index);\n\n    // }\n\n    // onClickBuy() {\n    //     if(this.isCheck && this.index < Global.dataHook.length) {\n    //         Global.dataHook[this.index].isBuy = true;\n    //         Global.totalGold -= Global.dataHook[this.index].price;\n    //         Global.speedHook += Global.dataHook[this.index].speed;\n    //         Global.lengthHook += Global.dataHook[this.index].widthHook;\n\n    //         this.nStateBuy.children[this.index].active = Global.dataHook[this.index].isBuy;\n    //         Global.activeIndex = this.index;\n\n    //         this.index++;\n    //         this.checkClick();\n    //         this.savePurchaseState();\n    //         ShuShiCarbGameManager.instance.updateTotalGold();\n    //         ShuShiCarbShopView.instace.updateGold();\n    //         this.updatePrice(this.index);\n    //         console.log(\"data Hoook \",Global.dataHook);\n    //     } else {\n    //         this.nCheckmask.active = true;\n    //         this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\n    //     }\n\n    // }\n\n    // updatePrice(index) {\n    //     if(index < Global.dataHook.length) {\n    //         this.lbPrice.string = Global.dataHook[index].price + ' '; \n    //         this.lbLeverSpeedNew.string = Global.dataHook[index].speed + 1 + ' ';\n    //         this.lbLeverSpeedOld.string = Global.dataHook[index].speed + ' ' +  ' -> ';\n    //     }else {\n    //         this.lbPrice.string = \"Max\";\n    //         this.lbLeverSpeedNew.string = \"Max\";\n    //         this.lbLeverSpeedOld.string = \"Max\";\n    //     }\n\n    // }\n    // start () {\n\n    // }\n\n    // update (dt) {}\n}\n"]}