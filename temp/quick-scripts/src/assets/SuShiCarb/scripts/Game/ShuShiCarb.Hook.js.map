{"version":3,"sources":["assets\\SuShiCarb\\scripts\\Game\\ShuShiCarb.Hook.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport ShuShiCarbFood from \"./ShuShiCarb.Food\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShuShiCarbHook extends cc.Component {\r\n    public static instance: ShuShiCarbHook = null;\r\n    @property(cc.Node)\r\n    hookRope: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    hookSpriteOpen: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    hookSpriteClose: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    hookHead: cc.Node = null;\r\n    \r\n    hookSpeed = 400;\r\n    hookState = 0;\r\n\r\n    hookHeadBaseY: number = 80;\r\n    hookRopeBaseWidth: number = 0;\r\n    \r\n    mousePos;\r\n    // initialLength: number = 100;  \r\n    // maxLength: number = 750;      \r\n    // growing: boolean = false;\r\n    onLoad() {\r\n        ShuShiCarbHook.instance = this;\r\n        cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);  \r\n        //  this.hookHeadBaseY = this.hookHeadBaseY || this.hookHead.y;\r\n        //  this.hookRopeBaseWidth = this.hookRopeBaseWidth || this.hookRope.width;\r\n    }\r\n\r\n\r\n    initHook()  {\r\n        this.hookHead.y  = this.hookHeadBaseY;\r\n        this.hookRope.width = this.hookRopeBaseWidth;\r\n    }\r\n\r\n    start() {\r\n        this.initHook();\r\n    }\r\n    setHookState(hookState) {\r\n        this.hookState = hookState;\r\n        console.log(\"hookState \",hookState);\r\n    }\r\n\r\n    setHookSprite(isOpen: boolean) {\r\n        this.hookSpriteClose.active = !isOpen;\r\n        this.hookSpriteOpen.active = isOpen;\r\n    }\r\n \r\n\r\n    onMouseDown(event: cc.Event.EventMouse) {\r\n        if(this.hookState !== 0) {\r\n            return;\r\n        }\r\n        this.hookState = 1;\r\n        this.mousePos = this.node.parent.convertToNodeSpaceAR(cc.v2(event.getLocationX()));\r\n\r\n        console.log(this.mousePos);\r\n        this.node.setPosition(this.mousePos);\r\n    }\r\n\r\n    moveHookHead(dt) {\r\n        this.hookHead.y += dt * 30;\r\n        this.hookRope.width -= dt * 40;\r\n      \r\n    }\r\n\r\n   \r\n   \r\n\r\n    getHookHeadGlobalPos(): cc.Vec2 {\r\n        return this.node.convertToWorldSpaceAR(cc.v2(this.mousePos, this.hookHead.y - 25));\r\n    }\r\n    onDestroy() {\r\n        cc.Canvas.instance.node.off(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\r\n    }\r\n    update(dt) {\r\n        this.setHookSprite(true);\r\n        switch(this.hookState) {\r\n            case 1:\r\n                if(this.hookHead.y) {\r\n                    this.moveHookHead(50 * dt);\r\n                    if(this.hookHead.y >= 1000) {\r\n                        this.hookState = 2;\r\n                     \r\n                    }\r\n                }\r\n                break;\r\n            case 2:\r\n                if(this.hookHead.y) {\r\n                    this.moveHookHead(-50  * dt);\r\n                    this.hookHead.getComponent(cc.BoxCollider).enabled = false;\r\n                    if(this.hookHead.y  < 0) {\r\n                        this.hookHead.y = 100;\r\n                        this.hookRope.width = 50;\r\n                        this.hookState = 0;\r\n                        this.hookHead.getComponent(cc.BoxCollider).enabled = true;\r\n                    }\r\n                }\r\n               \r\n                this.setHookSprite(false);\r\n                break;\r\n            case 0:\r\n                default:\r\n                    break;\r\n        }\r\n    }\r\n\r\n    // update(dt: number) {\r\n    //     if (this.growing) {\r\n    //         if (this.node.height < this.maxLength) {\r\n    //             this.node.height += 200 * 0.2;\r\n    //             this.node.getComponent(cc.BoxCollider).size.height += 200 * 0.2;\r\n    //         } else {\r\n    //             this.growing = false;\r\n    //             this.node.height = this.initialLength;\r\n    //             this.node.getComponent(cc.BoxCollider).size.height = this.initialLength;\r\n    //         }\r\n    //     }\r\n    // }\r\n\r\n    onCollisionEnter(other) {\r\n        // // Lấy bounding box của thanh kéo\r\n        // const dragBarBoundingBox = this.node.getBoundingBoxToWorld();\r\n\r\n        // // Lặp qua tất cả các món ăn để kiểm tra va chạm\r\n        // for (let i = 0; i < this.foodContainer.children.length; i++) {\r\n        //     const foodItem = this.foodContainer.children[i];\r\n        //     const foodBoundingBox = foodItem.getBoundingBoxToWorld();\r\n\r\n        //     if (dragBarBoundingBox.intersects(foodBoundingBox)) {\r\n        //         // Nếu va chạm, kéo món ăn về vị trí nhất định\r\n        //         foodItem.setPosition(cc.v2(100, 100));  // Ví dụ đặt về vị trí (100, 100)\r\n        //         break;  // Dừng lại sau khi tìm thấy va chạm đầu tiên\r\n        //     }\r\n        // }\r\n        \r\n      \r\n    }\r\n}"]}