{"version":3,"sources":["assets\\SuShiCarb\\scripts\\Game\\Ui_Popup\\Shop\\ShuShiCarb.ItemShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport ShuShiCarbGameManager from \"../../../ShuShiCarb.GameManager\";\r\nimport Global from \"../../../ShuShiCarb.Global\";\r\nimport ShuShiCarbShopView from \"./ShuShiCarb.ShopView\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShuShiCarbItemShop extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    nItemShop: cc.Node = null;\r\n    @property(cc.Label)\r\n    lbPrice: cc.Label = null;\r\n    @property(cc.Node)\r\n    nBtnBuy: cc.Node = null;\r\n    @property(cc.Node)\r\n    nStateBuy: cc.Node = null;\r\n   \r\n    // @property(cc.Label)\r\n    // lbLeverSpeedOld: cc.Label = null;\r\n    // @property(cc.Label)\r\n    // lbLeverSpeedNew: cc.Label = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    lsSpFItemShop: cc.SpriteFrame[] = [];\r\n    index = 0;\r\n    isCheck = false;\r\n    _data = null\r\n    _data2 = null;\r\n    _data3 = null;\r\n    itemId = 0;\r\n\r\n    onLoad() {\r\n        //this.checkClick();\r\n    }\r\n\r\n    setData(id) {\r\n        this.itemId = id;\r\n        switch (id) {\r\n            case 0: // hook\r\n                this.index = Global.hookIndex;\r\n                this._data = Global.dataHook[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                console.log(this._data,this.index);\r\n                break;\r\n            case 1: // Bag money\r\n                this.index = Global.bagIndex;\r\n                this._data = Global.dataBagMoney[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                // this.lbLeverSpeedOld.node.active = false;\r\n                // this.lbLeverSpeedNew.node.x = 27;\r\n                // this.lbLeverSpeedNew.node.y = 5;\r\n                break;\r\n            case 2: // time Happy\r\n                this._data = Global.dataTimeHappy[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                // this.lbLeverSpeedOld.node.active = false;\r\n                // this.lbLeverSpeedNew.node.x = 25;\r\n                // this.lbLeverSpeedNew.node.y = 6;\r\n                this.index = Global.timeIndex;\r\n                this.nStateBuy.x = -115;\r\n                this.nStateBuy.y = -28;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.updatePrice(this.index,Global.totalGold);\r\n    }\r\n\r\n    updatePrice(index, totalGold) {\r\n        if (index < 4) {\r\n            this.lbPrice.string = this._data.price + ' ';\r\n            if (totalGold >= this._data.price) {\r\n                //this.lbLeverSpeedOld.string = \"0\";\r\n                this.nBtnBuy.getComponent(cc.Button).interactable = true;\r\n            } else {\r\n                //this.lbLeverSpeedNew.string = this._data.price + ' ';\r\n                //this.lbLeverSpeedOld.string = this._data.price + ' ';\r\n                this.nBtnBuy.getComponent(cc.Button).interactable = false;\r\n            }\r\n        } else {\r\n            this.lbPrice.string = \"Max\";\r\n            //this.lbLeverSpeedNew.string = \"Max\";\r\n            //this.lbLeverSpeedOld.string = \"Max\";\r\n            this.nBtnBuy.getComponent(cc.Button).interactable = false;\r\n        }\r\n        this.updatePurchaseState();\r\n    }\r\n    // updatePrice(index, totalGold) {\r\n    //     if (index < 4) {\r\n    //         this.lbPrice.string = this._data.price + ' ';\r\n    //         if (totalGold >= this._data.price) {\r\n    //             switch (this.itemId) {\r\n    //                 case 0:\r\n                        \r\n    //                     break;\r\n                \r\n    //                 default:\r\n    //                     break;\r\n    //             }\r\n    //             this.lbLeverSpeedOld.string = \"0\";\r\n    //             this.nBtnBuy.getComponent(cc.Button).interactable = true;\r\n    //         } else {\r\n    //             this.lbLeverSpeedNew.string = this._data.price + ' ';\r\n    //             this.lbLeverSpeedOld.string = this._data.price + ' ';\r\n    //             this.nBtnBuy.getComponent(cc.Button).interactable = false;\r\n    //         }\r\n    //     } else {\r\n    //         this.lbPrice.string = \"Max\";\r\n    //         this.lbLeverSpeedNew.string = \"Max\";\r\n    //         this.lbLeverSpeedOld.string = \"Max\";\r\n    //         this.nBtnBuy.getComponent(cc.Button).interactable = false;\r\n    //     }\r\n    //     this.updatePurchaseState();\r\n    // }\r\n   \r\n\r\n    savePurchaseState() {\r\n        let purchaseData = {\r\n            dataHook: Global.dataHook,\r\n            dataBagMoney: Global.dataBagMoney,\r\n            dataTimeHappy: Global.dataTimeHappy,\r\n            activeIndexHook: Global.hookIndex,\r\n        };\r\n        cc.sys.localStorage.setItem('itemShopData', JSON.stringify(purchaseData));\r\n        \r\n        \r\n    }\r\n\r\n    updatePurchaseState() {\r\n        for (let i = 0; i <= this.index; i++) {\r\n            this.nStateBuy.children[i].active = true;\r\n        }\r\n    }\r\n\r\n    onBuy() {\r\n        if (Global.soundManager) {\r\n            Global.soundManager.playSoundClick();\r\n        }\r\n\r\n        if ( this.index < 4) {\r\n            this.nStateBuy.children[this.index].active = true;\r\n            Global.totalGold -= this._data.price;\r\n\r\n            switch (this.itemId) {\r\n                case 0:\r\n                    this.index++;\r\n                    Global.hookIndex = this.index;\r\n                    this._data = Global.dataHook[this.index];\r\n                    Global.speedHook += this._data.speed;\r\n                    Global.lengthHook += this._data.widthHook;\r\n                    cc.sys.localStorage.setItem(\"speedHook\",JSON.stringify(Global.speedHook));\r\n                    cc.sys.localStorage.setItem(\"lengthHook\",JSON.stringify(Global.lengthHook));\r\n                    cc.sys.localStorage.setItem(\"hookIndex\", this.index)\r\n                    break;\r\n                case 1:\r\n                    this.index++;\r\n                    Global.checkBagMoney = true;\r\n                    Global.bagIndex = this.index;\r\n                    this._data = Global.dataBagMoney[this.index];\r\n                    Global.moneyBag += this._data.gold;\r\n                    cc.sys.localStorage.setItem(\"moneyBag\",JSON.stringify(Global.moneyBag));\r\n                    cc.sys.localStorage.setItem(\"bagIndex\",this.index);\r\n                    cc.sys.localStorage.setItem(\"checkBagMoney\", JSON.stringify(Global.checkBagMoney));\r\n                    break;\r\n                case 2:\r\n                    this.index++\r\n                    Global.timeIndex = this.index;\r\n                    this._data = Global.dataTimeHappy[this.index];\r\n                    cc.sys.localStorage.setItem(\"timeIndex\", this.index);\r\n                    Global.timeHappy += this._data.time;\r\n                    cc.sys.localStorage.setItem(\"timeHappy\",JSON.stringify(Global.timeHappy));\r\n                    //console.log(\"Index \", this.index);\r\n                    break;\r\n            }\r\n           \r\n            this.savePurchaseState();\r\n          \r\n            this.updatePrice(this.index,Global.totalGold);\r\n            ShuShiCarbGameManager.instance.updateTotalGold();\r\n            ShuShiCarbShopView.instance.updateGold(); \r\n            ShuShiCarbShopView.instance.updateItemsState(Global.totalGold);\r\n           \r\n        }\r\n\r\n        \r\n    }\r\n}\r\n"]}