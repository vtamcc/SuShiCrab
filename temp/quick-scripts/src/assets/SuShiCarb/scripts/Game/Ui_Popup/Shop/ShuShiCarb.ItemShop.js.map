{"version":3,"sources":["assets\\SuShiCarb\\scripts\\Game\\Ui_Popup\\Shop\\ShuShiCarb.ItemShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport ShuShiCarbGameManager from \"../../../ShuShiCarb.GameManager\";\r\nimport Global from \"../../../ShuShiCarb.Global\";\r\nimport ShuShiCarbShopView from \"./ShuShiCarb.ShopView\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShuShiCarbItemShop extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    nItemShop: cc.Node = null;\r\n    @property(cc.Label)\r\n    lbPrice: cc.Label = null;\r\n    @property(cc.Node)\r\n    nBtnBuy: cc.Node = null;\r\n    @property(cc.Node)\r\n    nStateBuy: cc.Node = null;\r\n   \r\n    @property(cc.Label)\r\n    lbLeverSpeedOld: cc.Label = null;\r\n    @property(cc.Label)\r\n    lbLeverSpeedNew: cc.Label = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    lsSpFItemShop: cc.SpriteFrame[] = [];\r\n    index = 0;\r\n    isCheck = false;\r\n    _data = null\r\n    itemId = 0;\r\n\r\n    onLoad() {\r\n        //this.checkClick();\r\n    }\r\n\r\n    setData(id) {\r\n        this.itemId = id;\r\n        switch (id) {\r\n            case 0: // hook\r\n                this.index = Global.hookIndex;\r\n                this._data = Global.dataHook[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                console.log(this._data,this.index);\r\n                break;\r\n            case 1: // Bag money\r\n                this.index = Global.bagIndex;\r\n                this._data = Global.dataBagMoney[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                this.lbLeverSpeedOld.node.active = false;\r\n                break;\r\n            case 2: // time Happy\r\n                this._data = Global.dataTimeHappy[this.index];\r\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\r\n                this.lbLeverSpeedOld.node.active = false;\r\n                this.index = Global.timeIndex;\r\n\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.updatePrice(this.index);\r\n\r\n    }\r\n\r\n    updatePrice(index) {\r\n        if (index < 4) {\r\n            this.lbPrice.string = this._data.price + ' ';\r\n            this.lbLeverSpeedOld.string = \"0\";\r\n            //this.lbLeverSpeedNew.string = this._data[index].gold ? this._data[index].gold + ' ' : this._data[index].time + ' ';\r\n            this.nBtnBuy.getComponent(cc.Button).interactable = true;\r\n            console.log(\"Vao If \")\r\n        } else {\r\n            this.lbPrice.string = \"Max\";\r\n            this.lbLeverSpeedNew.string = \"Max\";\r\n            this.lbLeverSpeedOld.string = \"Max\";\r\n            this.nBtnBuy.getComponent(cc.Button).interactable = false;\r\n            console.log(\"vao Else\");\r\n        }\r\n\r\n        this.updatePurchaseState();\r\n    }\r\n\r\n    savePurchaseState() {\r\n        let purchaseData = {\r\n            dataHook: Global.dataHook,\r\n            dataBagMoney: Global.dataBagMoney,\r\n            dataTimeHappy: Global.dataTimeHappy,\r\n            activeIndexHook: Global.hookIndex,\r\n        };\r\n        cc.sys.localStorage.setItem('itemShopData', JSON.stringify(purchaseData));\r\n        \r\n    \r\n\r\n    }\r\n\r\n    updatePurchaseState() {\r\n        for (let i = 0; i <= this.index; i++) {\r\n            this.nStateBuy.children[i].active = true;\r\n        }\r\n    }\r\n\r\n    checkBuy(): boolean {\r\n        return Global.totalGold >= this._data.price;\r\n    }\r\n\r\n    onBuy() {\r\n        if ( this.index < 4) {\r\n            this.nStateBuy.children[this.index].active = true;\r\n            Global.totalGold -= this._data.price;\r\n\r\n            switch (this.itemId) {\r\n                case 0:\r\n                    this.index++;\r\n                    Global.hookIndex = this.index;\r\n                    this._data = Global.dataHook[this.index];\r\n                    cc.sys.localStorage.setItem(\"hookIndex\", this.index)\r\n                    break;\r\n                case 1:\r\n                    this.index++;\r\n                    Global.checkBagMoney = true;\r\n                    Global.bagIndex = this.index;\r\n                    this._data = Global.dataBagMoney[this.index];\r\n                    cc.sys.localStorage.setItem(\"bagIndex\",this.index);\r\n                    cc.sys.localStorage.setItem(\"checkBagMoney\", JSON.stringify(Global.checkBagMoney));\r\n                    break;\r\n                case 2:\r\n                    this.index++\r\n                    Global.timeIndex = this.index;\r\n                    this._data = Global.dataTimeHappy[this.index];\r\n                    cc.sys.localStorage.setItem(\"timeIndex\", this.index);\r\n                    //console.log(\"Index \", this.index);\r\n                    break;\r\n            }\r\n            this.updatePrice(this.index);\r\n            this.savePurchaseState();\r\n            ShuShiCarbGameManager.instance.updateTotalGold();\r\n            ShuShiCarbShopView.instance.updateGold();\r\n            \r\n            //this.checkClick(); // Gọi lại checkClick để cập nhật trạng thái nút sau khi mua\r\n        }\r\n    }\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n\r\n    // onLoad () {\r\n    //     this.index = JSON.parse(cc.sys.localStorage.getItem(\"itemIndex\")) || 0;\r\n    //     this.loadPurchaseState();\r\n    //     this.checkClick();\r\n    //     this.updatePrice(this.index);\r\n    // }\r\n\r\n    // loadPurchaseState() {\r\n    //     const purchaseData = JSON.parse(cc.sys.localStorage.getItem(\"purchaseData\")) || [];\r\n    //     for (let i = 0; i < Global.dataHook.length; i++) {\r\n    //         if (purchaseData[i]) {\r\n    //             Global.dataHook[i].isBuy = purchaseData[i].isBuy;\r\n    //             Global.dataHook[i].speed = purchaseData[i].speed;\r\n    //             this.nStateBuy.children[i].active = purchaseData[i].isBuy;\r\n    //         }\r\n    //     }\r\n    // }\r\n\r\n    // savePurchaseState() {\r\n    //     const purchaseData = Global.dataHook.map(item => ({\r\n    //         isBuy: item.isBuy,\r\n    //         speed: item.speed\r\n    //     }));\r\n    //     cc.sys.localStorage.setItem('purchaseData', JSON.stringify(purchaseData));\r\n    //     cc.sys.localStorage.setItem('activeIndex', JSON.stringify(Global.activeIndex));\r\n    //     cc.sys.localStorage.setItem('itemIndex', this.index.toString());\r\n    //     cc.sys.localStorage.setItem('speedHook', JSON.stringify(Global.speedHook));\r\n    //     cc.sys.localStorage.setItem('lengthHook', JSON.stringify(Global.lengthHook));\r\n    // }\r\n\r\n\r\n    // checkClick() {\r\n    //     // if(this.index < Global.dataHook.length) {\r\n    //     //     if(Global.totalGold >= Global.dataHook[this.index].price) {\r\n    //     //         this.nCheckmask.active = false;\r\n    //     //         this.isCheck = true;\r\n    //     //     }else {\r\n    //     //          this.nCheckmask.active = true;\r\n    //     //          this.isCheck = false;\r\n    //     //          this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\r\n    //     //      }\r\n    //     // }\r\n    //     if(this.index < Global.dataHook.length && Global.totalGold >= Global.dataHook[this.index].price) { \r\n    //             this.nCheckmask.active = false;\r\n    //             this.isCheck = true; \r\n    //     }\r\n    //     else {\r\n    //         this.nCheckmask.active = true;\r\n    //         this.isCheck = false;\r\n    //         this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\r\n    //     }\r\n    //     console.log(this.index);\r\n\r\n    // }\r\n\r\n    // onClickBuy() {\r\n    //     if(this.isCheck && this.index < Global.dataHook.length) {\r\n    //         Global.dataHook[this.index].isBuy = true;\r\n    //         Global.totalGold -= Global.dataHook[this.index].price;\r\n    //         Global.speedHook += Global.dataHook[this.index].speed;\r\n    //         Global.lengthHook += Global.dataHook[this.index].widthHook;\r\n\r\n    //         this.nStateBuy.children[this.index].active = Global.dataHook[this.index].isBuy;\r\n    //         Global.activeIndex = this.index;\r\n\r\n    //         this.index++;\r\n    //         this.checkClick();\r\n    //         this.savePurchaseState();\r\n    //         ShuShiCarbGameManager.instance.updateTotalGold();\r\n    //         ShuShiCarbShopView.instace.updateGold();\r\n    //         this.updatePrice(this.index);\r\n    //         console.log(\"data Hoook \",Global.dataHook);\r\n    //     } else {\r\n    //         this.nCheckmask.active = true;\r\n    //         this.nBtnBuy.getComponent(cc.Toggle).interactable = false;\r\n    //     }\r\n\r\n    // }\r\n\r\n    // updatePrice(index) {\r\n    //     if(index < Global.dataHook.length) {\r\n    //         this.lbPrice.string = Global.dataHook[index].price + ' '; \r\n    //         this.lbLeverSpeedNew.string = Global.dataHook[index].speed + 1 + ' ';\r\n    //         this.lbLeverSpeedOld.string = Global.dataHook[index].speed + ' ' +  ' -> ';\r\n    //     }else {\r\n    //         this.lbPrice.string = \"Max\";\r\n    //         this.lbLeverSpeedNew.string = \"Max\";\r\n    //         this.lbLeverSpeedOld.string = \"Max\";\r\n    //     }\r\n\r\n    // }\r\n    // start () {\r\n\r\n    // }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}