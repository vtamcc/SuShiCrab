{"version":3,"sources":["assets/SuShiCarb/scripts/Game/Ui_Popup/Shop/ShuShiCarb.ItemShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport ShuShiCarbGameManager from \"../../../ShuShiCarb.GameManager\";\nimport Global from \"../../../ShuShiCarb.Global\";\nimport ShuShiCarbShopView from \"./ShuShiCarb.ShopView\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ShuShiCarbItemShop extends cc.Component {\n\n    @property(cc.Node)\n    nItemShop: cc.Node = null;\n    @property(cc.Label)\n    lbPrice: cc.Label = null;\n    @property(cc.Node)\n    nBtnBuy: cc.Node = null;\n    @property(cc.Node)\n    nStateBuy: cc.Node = null;\n   \n    // @property(cc.Label)\n    // lbLeverSpeedOld: cc.Label = null;\n    // @property(cc.Label)\n    // lbLeverSpeedNew: cc.Label = null;\n\n    @property(cc.SpriteFrame)\n    lsSpFItemShop: cc.SpriteFrame[] = [];\n    index = 0;\n    isCheck = false;\n    _data = null\n    _data2 = null;\n    _data3 = null;\n    itemId = 0;\n\n    onLoad() {\n        //this.checkClick();\n    }\n\n    setData(id) {\n        this.itemId = id;\n        switch (id) {\n            case 0: // hook\n                this.index = Global.hookIndex;\n                this._data = Global.dataHook[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                console.log(this._data,this.index);\n                break;\n            case 1: // Bag money\n                this.index = Global.bagIndex;\n                this._data = Global.dataBagMoney[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                // this.lbLeverSpeedOld.node.active = false;\n                // this.lbLeverSpeedNew.node.x = 27;\n                // this.lbLeverSpeedNew.node.y = 5;\n                break;\n            case 2: // time Happy\n                this._data = Global.dataTimeHappy[this.index];\n                this.nItemShop.getComponent(cc.Sprite).spriteFrame = this.lsSpFItemShop[id];\n                // this.lbLeverSpeedOld.node.active = false;\n                // this.lbLeverSpeedNew.node.x = 25;\n                // this.lbLeverSpeedNew.node.y = 6;\n                this.index = Global.timeIndex;\n                this.nStateBuy.x = -115;\n                this.nStateBuy.y = -28;\n                break;\n            default:\n                break;\n        }\n        this.updatePrice(this.index,Global.totalGold);\n    }\n\n    updatePrice(index, totalGold) {\n        if (index < 4) {\n            this.lbPrice.string = this._data.price + ' ';\n            if (totalGold >= this._data.price) {\n                //this.lbLeverSpeedOld.string = \"0\";\n                this.nBtnBuy.getComponent(cc.Button).interactable = true;\n            } else {\n                //this.lbLeverSpeedNew.string = this._data.price + ' ';\n                //this.lbLeverSpeedOld.string = this._data.price + ' ';\n                this.nBtnBuy.getComponent(cc.Button).interactable = false;\n            }\n        } else {\n            this.lbPrice.string = \"Max\";\n            //this.lbLeverSpeedNew.string = \"Max\";\n            //this.lbLeverSpeedOld.string = \"Max\";\n            this.nBtnBuy.getComponent(cc.Button).interactable = false;\n        }\n        this.updatePurchaseState();\n    }\n    // updatePrice(index, totalGold) {\n    //     if (index < 4) {\n    //         this.lbPrice.string = this._data.price + ' ';\n    //         if (totalGold >= this._data.price) {\n    //             switch (this.itemId) {\n    //                 case 0:\n                        \n    //                     break;\n                \n    //                 default:\n    //                     break;\n    //             }\n    //             this.lbLeverSpeedOld.string = \"0\";\n    //             this.nBtnBuy.getComponent(cc.Button).interactable = true;\n    //         } else {\n    //             this.lbLeverSpeedNew.string = this._data.price + ' ';\n    //             this.lbLeverSpeedOld.string = this._data.price + ' ';\n    //             this.nBtnBuy.getComponent(cc.Button).interactable = false;\n    //         }\n    //     } else {\n    //         this.lbPrice.string = \"Max\";\n    //         this.lbLeverSpeedNew.string = \"Max\";\n    //         this.lbLeverSpeedOld.string = \"Max\";\n    //         this.nBtnBuy.getComponent(cc.Button).interactable = false;\n    //     }\n    //     this.updatePurchaseState();\n    // }\n   \n\n    savePurchaseState() {\n        let purchaseData = {\n            dataHook: Global.dataHook,\n            dataBagMoney: Global.dataBagMoney,\n            dataTimeHappy: Global.dataTimeHappy,\n            activeIndexHook: Global.hookIndex,\n        };\n        cc.sys.localStorage.setItem('itemShopData', JSON.stringify(purchaseData));\n        \n        \n    }\n\n    updatePurchaseState() {\n        for (let i = 0; i <= this.index; i++) {\n            this.nStateBuy.children[i].active = true;\n        }\n    }\n\n    onBuy() {\n        if (Global.soundManager) {\n            Global.soundManager.playSoundClick();\n        }\n\n        if ( this.index < 4) {\n            this.nStateBuy.children[this.index].active = true;\n            Global.totalGold -= this._data.price;\n\n            switch (this.itemId) {\n                case 0:\n                    this.index++;\n                    Global.hookIndex = this.index;\n                    this._data = Global.dataHook[this.index];\n                    Global.speedHook += this._data.speed;\n                    Global.lengthHook += this._data.widthHook;\n                    cc.sys.localStorage.setItem(\"speedHook\",JSON.stringify(Global.speedHook));\n                    cc.sys.localStorage.setItem(\"lengthHook\",JSON.stringify(Global.lengthHook));\n                    cc.sys.localStorage.setItem(\"hookIndex\", this.index)\n                    break;\n                case 1:\n                    this.index++;\n                    Global.checkBagMoney = true;\n                    Global.bagIndex = this.index;\n                    this._data = Global.dataBagMoney[this.index];\n                    Global.moneyBag += this._data.gold;\n                    cc.sys.localStorage.setItem(\"moneyBag\",JSON.stringify(Global.moneyBag));\n                    cc.sys.localStorage.setItem(\"bagIndex\",this.index);\n                    cc.sys.localStorage.setItem(\"checkBagMoney\", JSON.stringify(Global.checkBagMoney));\n                    break;\n                case 2:\n                    this.index++\n                    Global.timeIndex = this.index;\n                    this._data = Global.dataTimeHappy[this.index];\n                    cc.sys.localStorage.setItem(\"timeIndex\", this.index);\n                    Global.timeHappy += this._data.time;\n                    cc.sys.localStorage.setItem(\"timeHappy\",JSON.stringify(Global.timeHappy));\n                    //console.log(\"Index \", this.index);\n                    break;\n            }\n           \n            this.savePurchaseState();\n          \n            this.updatePrice(this.index,Global.totalGold);\n            ShuShiCarbGameManager.instance.updateTotalGold();\n            ShuShiCarbShopView.instance.updateGold(); \n            ShuShiCarbShopView.instance.updateItemsState(Global.totalGold);\n           \n        }\n\n        \n    }\n}\n"]}